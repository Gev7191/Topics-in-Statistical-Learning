rep("Employee", n_sex),
rep("Worker",n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_Males, salary$sal_M_executive, salary$sal_M_midManager, salary$sal_M_employee, salary$sal_M_worker,
salary$sal_Females, salary$sal_F_executive, salary$sal_F_midManager, salary$sal_F_employee, salary$sal_F_worker),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("x-axis") + ylab("y-axis") + ggtitle("Gender comparison") +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p
# excluding outliers
p2 <- ggplot(data = sal_sex, aes(x=Label, y=value)) +
scale_y_continuous(limits = quantile(sal_sex$value, c(0, 0.9))) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("x-axis") + ylab("y-axis") + ggtitle("Gender comparison excluding the last decile") +
# p <- p + guides(fill=guide_legend(title="Legend"))
stat_boxplot(geom = "errorbar", width = 0.5)
p2
salary$salary_ratio_FvsM <- salary$sal_Females / salary$sal_Males
# gender salary ratio and income
# The higher the net mean income, the more skewed the ratio of salary between female and male is.
names(salary)
names(salary)
salary$salary_ratio_FvsM <- salary$sal_Females / salary$sal_Males
ggplot(salary, aes(x= sal_general, y=salary_ratio_FvsM)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
names(salary)
salary$salary_ratio_FvsM_Exec <- salary$sal_F_executive / salary$sal_M_executive
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_Exec)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
hist(salary$salary_ratio_FvsM_Exec)
# Overall mean salary
# The higher the net mean income, the more skewed the ratio of salary between female and male is.
# only 2 towns have a ratio>1
hist(salary$salary_ratio_FvsM)
# Executives mean salary
# a bit better and less skewed
hist(salary$salary_ratio_FvsM_Exec)
# Executives mean salary
# a bit better and less skewed
salary$salary_ratio_FvsM_Exec <- salary$sal_F_executive / salary$sal_M_executive
# Executives mean salary
# a bit better and less skewed
salary$salary_ratio_FvsM_midManag <- salary$sal_F_midManager / salary$sal_M_midManager
hist(salary$salary_ratio_FvsM_midManag)
salary$salary_ratio_FvsM_midManag <- salary$sal_F_midManager / salary$sal_M_midManager
hist(salary$salary_ratio_FvsM_midManag)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_midManag)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
# Middle managers mean salary
# ..
salary$salary_ratio_FvsM_worker <- salary$sal_F_worker / salary$sal_M_worker
hist(salary$salary_ratio_FvsM_worker)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_worker)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
# Employee mean salary
# ..
salary$salary_ratio_FvsM_employee <- salary$sal_F_employee / salary$sal_M_employee
salary$salary_ratio_FvsM_employee <- salary$sal_F_employee / salary$sal_M_employee
hist(salary$salary_ratio_FvsM_employee)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_employee)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
# Gender salary ratio and general level of income
# Overall mean salary
# The higher the net mean income, the more skewed the ratio of salary between female and male is.
# only 2 towns have a ratio>1
salary$salary_ratio_FvsM <- salary$sal_Females / salary$sal_Males
hist(salary$salary_ratio_FvsM)
ggplot(salary, aes(x= sal_general, y=salary_ratio_FvsM)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
# Executives mean salary
# a bit better and less skewed
salary$salary_ratio_FvsM_Exec <- salary$sal_F_executive / salary$sal_M_executive
hist(salary$salary_ratio_FvsM_Exec)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_Exec)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
# Middle managers mean salary
# ..
salary$salary_ratio_FvsM_midManag <- salary$sal_F_midManager / salary$sal_M_midManager
hist(salary$salary_ratio_FvsM_midManag)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_midManag)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
# Middle managers mean salary
# ..
salary$salary_ratio_FvsM_worker <- salary$sal_F_worker / salary$sal_M_worker
hist(salary$salary_ratio_FvsM_worker)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_worker)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
# Employee mean salary
# ..
salary$salary_ratio_FvsM_employee <- salary$sal_F_employee / salary$sal_M_employee
hist(salary$salary_ratio_FvsM_employee)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_employee)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
salary$salary_ratio_FvsM <- salary$sal_Females / salary$sal_Males
hist(salary$salary_ratio_FvsM)
ggplot(salary, aes(x= sal_general, y=salary_ratio_FvsM)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
# a bit better and less skewed
salary$salary_ratio_FvsM_Exec <- salary$sal_F_executive / salary$sal_M_executive
hist(salary$salary_ratio_FvsM_Exec)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_Exec)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
salary$salary_ratio_FvsM_midManag <- salary$sal_F_midManager / salary$sal_M_midManager
hist(salary$salary_ratio_FvsM_midManag)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_midManag)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
salary$salary_ratio_FvsM_employee <- salary$sal_F_employee / salary$sal_M_employee
hist(salary$salary_ratio_FvsM_employee)
ggplot(salary, aes(x= sal_general, y= salary_ratio_FvsM_employee)) +
geom_point(size = 0.5, colour = "#0091ff")+
geom_smooth()
??ddply
require(dplyr)
?ddply
require(ggplot2)
#  number of units
n_sex <- length(salary$sal_Females)
# vector representing males and females
Label <- c(rep("M", n_sex*5), rep("F", n_sex*5))
# vector representing the variable considered
Variable <- c(rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex),
rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_Males, salary$sal_M_executive, salary$sal_M_midManager, salary$sal_M_employee, salary$sal_M_worker,
salary$sal_Females, salary$sal_F_executive, salary$sal_F_midManager, salary$sal_F_employee, salary$sal_F_worker),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("x-axis") + ylab("y-axis") + ggtitle("Gender comparison") +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p
# excluding outliers
p2 <- ggplot(data = sal_sex, aes(x=Label, y=value)) +
scale_y_continuous(limits = quantile(sal_sex$value, c(0, 0.9))) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + ggtitle("Gender comparison excluding the last decile") +
# p <- p + guides(fill=guide_legend(title="Legend"))
stat_boxplot(geom = "errorbar", width = 0.5)
p2
median(salary$sal_Females)
median(salary$sal_Mles)
median(salary$sal_Males)
median(salary$sal_M_employee)
median(salary$sal_M_worker)
median(salary$sal_M_midManager)
require(ggplot2)
#  number of units
n_sex <- length(salary$sal_Females)
# vector representing males and females
Label <- c(rep("M", n_sex*3), rep("F", n_sex*3))
# vector representing the variable considered
Variable <- c(rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex),
rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_M_18_25, salary$sal_M_26_50, salary$sal_M_51plus,
salary$sal_F_18_25, salary$sal_F_26_50, salary$sal_F_51plus),
Variable = Variable)
# plotting phase
p3 <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("x-axis") + ylab("y-axis") + ggtitle("Gender comparison for different ages") +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p3
require(ggplot2)
#  number of units
n_sex <- length(salary$sal_Females)
# vector representing males and females
Label <- c(rep("M", n_sex*5), rep("F", n_sex*5))
# vector representing the variable considered
Variable <- c(rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex),
rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_Males, salary$sal_M_executive, salary$sal_M_midManager, salary$sal_M_employee, salary$sal_M_worker,
salary$sal_Females, salary$sal_F_executive, salary$sal_F_midManager, salary$sal_F_employee, salary$sal_F_worker),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("x-axis") + ylab("y-axis") + ggtitle("Gender comparison for different job positions") +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p
# excluding outliers
p <- ggplot(data = sal_sex, aes(x=Label, y=value)) +
scale_y_continuous(limits = quantile(sal_sex$value, c(0, 0.9))) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + ggtitle("Gender comparison excluding the last decile") +
# p <- p + guides(fill=guide_legend(title="Legend"))
stat_boxplot(geom = "errorbar", width = 0.5)
p
# vector representing males and females
Label <- c(rep("M", n_sex*3), rep("F", n_sex*3))
# vector representing the variable considered
Variable <- c(rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex),
rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_M_18_25, salary$sal_M_26_50, salary$sal_M_51plus,
salary$sal_F_18_25, salary$sal_F_26_50, salary$sal_F_51plus),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + ggtitle("Gender comparison for different ages") +
ylim = c(5, 100) +
stat_boxplot(geom = "errorbar", width = 0.5)
require(ggplot2)
#  number of units
n_sex <- length(salary$sal_Females)
# vector representing males and females
Label <- c(rep("M", n_sex*5), rep("F", n_sex*5))
# vector representing the variable considered
Variable <- c(rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex),
rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_Males, salary$sal_M_executive, salary$sal_M_midManager, salary$sal_M_employee, salary$sal_M_worker,
salary$sal_Females, salary$sal_F_executive, salary$sal_F_midManager, salary$sal_F_employee, salary$sal_F_worker),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("x-axis") + ylab("y-axis") + ggtitle("Gender comparison for different job positions") +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p
# excluding outliers
p <- ggplot(data = sal_sex, aes(x=Label, y=value)) +
scale_y_continuous(limits = quantile(sal_sex$value, c(0, 0.9))) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + ggtitle("Gender comparison excluding the last decile") +
# p <- p + guides(fill=guide_legend(title="Legend"))
stat_boxplot(geom = "errorbar", width = 0.5)
p
# vector representing males and females
Label <- c(rep("M", n_sex*3), rep("F", n_sex*3))
# vector representing the variable considered
Variable <- c(rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex),
rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_M_18_25, salary$sal_M_26_50, salary$sal_M_51plus,
salary$sal_F_18_25, salary$sal_F_26_50, salary$sal_F_51plus),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + ggtitle("Gender comparison for different ages") +
ylim(c(5, 100)) +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p
require(ggplot2)
#  number of units
n_sex <- length(salary$sal_Females)
# vector representing males and females
Label <- c(rep("M", n_sex*5), rep("F", n_sex*5))
# vector representing the variable considered
Variable <- c(rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex),
rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_Males, salary$sal_M_executive, salary$sal_M_midManager, salary$sal_M_employee, salary$sal_M_worker,
salary$sal_Females, salary$sal_F_executive, salary$sal_F_midManager, salary$sal_F_employee, salary$sal_F_worker),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("x-axis") + ylab("y-axis") + ggtitle("Gender comparison for different job positions") +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p
# excluding outliers
p <- ggplot(data = sal_sex, aes(x=Label, y=value)) +
scale_y_continuous(limits = quantile(sal_sex$value, c(0, 0.9))) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + ggtitle("Gender comparison excluding the last decile") +
# p <- p + guides(fill=guide_legend(title="Legend"))
stat_boxplot(geom = "errorbar", width = 0.5)
p
# vector representing males and females
Label <- c(rep("M", n_sex*3), rep("F", n_sex*3))
# vector representing the variable considered
Variable <- c(rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex),
rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_M_18_25, salary$sal_M_26_50, salary$sal_M_51plus,
salary$sal_F_18_25, salary$sal_F_26_50, salary$sal_F_51plus),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + ggtitle("Gender comparison for different ages") +
theme(plot.title = element_text(hjust = 0.5)) + ylim(c(5, 100)) +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p
require(ggplot2)
#  number of units
n_sex <- length(salary$sal_Females)
# vector representing males and females
Label <- c(rep("M", n_sex*5), rep("F", n_sex*5))
# vector representing the variable considered
Variable <- c(rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex),
rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_Males, salary$sal_M_executive, salary$sal_M_midManager, salary$sal_M_employee, salary$sal_M_worker,
salary$sal_Females, salary$sal_F_executive, salary$sal_F_midManager, salary$sal_F_employee, salary$sal_F_worker),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + + ggtitle("Gender comparison for different job positions") +
theme(plot.title = element_text(hjust = 0.5)) +
stat_boxplot(geom = "errorbar", width = 0.5)
require(ggplot2)
#  number of units
n_sex <- length(salary$sal_Females)
# vector representing males and females
Label <- c(rep("M", n_sex*5), rep("F", n_sex*5))
# vector representing the variable considered
Variable <- c(rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex),
rep("General", n_sex),
rep("Executive", n_sex),
rep("MidManager", n_sex),
rep("Employee", n_sex),
rep("Worker",n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_Males, salary$sal_M_executive, salary$sal_M_midManager, salary$sal_M_employee, salary$sal_M_worker,
salary$sal_Females, salary$sal_F_executive, salary$sal_F_midManager, salary$sal_F_employee, salary$sal_F_worker),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + ggtitle("Gender comparison for different job positions") +
theme(plot.title = element_text(hjust = 0.5)) +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p
# excluding outliers
p <- ggplot(data = sal_sex, aes(x=Label, y=value)) +
scale_y_continuous(limits = quantile(sal_sex$value, c(0, 0.9))) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") +
ggtitle("Gender comparison for different job positions excluding the last decile") +
theme(plot.title = element_text(hjust = 0.5)) +
# p <- p + guides(fill=guide_legend(title="Legend"))
stat_boxplot(geom = "errorbar", width = 0.5)
p
# vector representing males and females
Label <- c(rep("M", n_sex*3), rep("F", n_sex*3))
# vector representing the variable considered
Variable <- c(rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex),
rep("18-25", n_sex),
rep("26-50", n_sex),
rep("51+", n_sex))
# merge these data
sal_sex = cbind.data.frame(Label = Label,
value = c(salary$sal_M_18_25, salary$sal_M_26_50, salary$sal_M_51plus,
salary$sal_F_18_25, salary$sal_F_26_50, salary$sal_F_51plus),
Variable = Variable)
# plotting phase
p <-  ggplot(data = sal_sex, aes(x=Label, y=value)) +
geom_boxplot(aes(fill = Label)) +
# not color points replacing colour = group instead of colour=Label
geom_point(aes(y=value, colour=Label), position = position_dodge(width=0.75)) +
facet_wrap( ~ Variable, scales="free") +
xlab("Sex") + ylab("Mean net salary per hour") + ggtitle("Gender comparison for different ages") +
theme(plot.title = element_text(hjust = 0.5)) + ylim(c(5, 100)) +
stat_boxplot(geom = "errorbar", width = 0.5)
# p <- p + guides(fill=guide_legend(title="Legend"))
p
